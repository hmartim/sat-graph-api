get:
  tags:
    - "Deterministic Fetch Actions"
  summary: "Gets the single Version of an Item that was valid at a specific time."
  operationId: "getValidVersion"
  description: |
    The core temporal resolution function. It finds the single `Version` of a given `Item` that was legally in force at a specific point in time.

    ### Discussion
    This endpoint retrieves the last version valid at any point during the day of the given timestamp, ensuring deterministic temporal resolution for legal document retrieval.
  security:
    - ApiKeyAuth: []

  parameters:
    - name: itemId
      in: path
      required: true
      description: "The canonical ID of the Item whose valid version is being requested."
      schema:
        $ref: '#/components/schemas/ID'
    - name: timestamp
      in: query
      required: true
      description: "The specific UTC date-time for which to check validity."
      schema:
        type: string
        format: date-time
      example: "1999-06-01T12:00:00Z"

  responses:
    '200':
      description: "Successfully retrieved the unique Version object valid at the specified time."
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Version'
    '404':
      description: "Not Found - Either the Item with the given ID does not exist, or it existed but had no version that was valid at the specified timestamp."
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    '400':
      $ref: '#/components/responses/BadRequest'
    '401':
      $ref: '#/components/responses/Unauthorized'
    '403':
      $ref: '#/components/responses/Forbidden'
